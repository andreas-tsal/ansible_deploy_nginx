---
- hosts: webserver
  become: true
  tasks:
  - name: ensure apache is at the latest version
    apt: name=nginx state=present
  - name: ensure ngninx started
    service: name=nginx state=started enabled=yes
  - name: configure nginx site
    template: src=templates/nginx.conf.j2 dest=/etc/nginx/sites-available/demo mode=0644
    notify: restart nginx

  handlers:
    - name: restart nginx
      service: name=nginx state=restarted